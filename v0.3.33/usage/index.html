<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Using the SciML Symbolic Indexing Interface · SymbolicIndexingInterface.jl</title><meta name="title" content="Using the SciML Symbolic Indexing Interface · SymbolicIndexingInterface.jl"/><meta property="og:title" content="Using the SciML Symbolic Indexing Interface · SymbolicIndexingInterface.jl"/><meta property="twitter:title" content="Using the SciML Symbolic Indexing Interface · SymbolicIndexingInterface.jl"/><meta name="description" content="Documentation for SymbolicIndexingInterface.jl."/><meta property="og:description" content="Documentation for SymbolicIndexingInterface.jl."/><meta property="twitter:description" content="Documentation for SymbolicIndexingInterface.jl."/><meta property="og:url" content="https://docs.sciml.ai/SymbolicIndexingInterface/stable/usage/"/><meta property="twitter:url" content="https://docs.sciml.ai/SymbolicIndexingInterface/stable/usage/"/><link rel="canonical" href="https://docs.sciml.ai/SymbolicIndexingInterface/stable/usage/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SymbolicIndexingInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SymbolicIndexingInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../terminology/">Terminology</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Using the SciML Symbolic Indexing Interface</a><ul class="internal"><li><a class="tocitem" href="#Symbolic-Indexing-of-Differential-Equation-Solutions"><span>Symbolic Indexing of Differential Equation Solutions</span></a></li><li><a class="tocitem" href="#Parameter-Indexing:-Getting-and-Setting-Parameter-Values"><span>Parameter Indexing: Getting and Setting Parameter Values</span></a></li><li><a class="tocitem" href="#Re-creating-a-buffer"><span>Re-creating a buffer</span></a></li></ul></li><li><a class="tocitem" href="../simple_sii_sys/">Simple Demonstration of a Symbolic System Structure</a></li><li><a class="tocitem" href="../complete_sii/">Implementing the Complete Symbolic Indexing Interface</a></li></ul></li><li><a class="tocitem" href="../solution_wrappers/">Defining Solution Wrapper Fallbacks</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Using the SciML Symbolic Indexing Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Using the SciML Symbolic Indexing Interface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/SymbolicIndexingInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/SymbolicIndexingInterface.jl/blob/master/docs/src/usage.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-the-SciML-Symbolic-Indexing-Interface"><a class="docs-heading-anchor" href="#Using-the-SciML-Symbolic-Indexing-Interface">Using the SciML Symbolic Indexing Interface</a><a id="Using-the-SciML-Symbolic-Indexing-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-SciML-Symbolic-Indexing-Interface" title="Permalink"></a></h1><p>This tutorial will cover ways to use the symbolic indexing interface for types that implement it. SciML&#39;s core types (problems, solutions, and iterator (integrator) types) all support this symbolic indexing interface which allows for domain-specific interfaces (such as ModelingToolkit, Catalyst, etc.) to seamlessly blend their symbolic languages with the types obtained from SciML. Other tutorials will focus on how users can make use of the interface for their own DSL, this tutorial will simply focus on what the user experience looks like for DSL which have set it up.</p><p>We recommend any DSL implementing the symbolic indexing interface to link to this tutorial as a full description of the functionality.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>While this tutorial focuses on demonstrating the symbolic indexing interface for ODEs, note that the same functionality works across all of the other problem types, such as optimization problems, nonlinear problems, nonlinear solutions, etc.</p></div></div><h2 id="Symbolic-Indexing-of-Differential-Equation-Solutions"><a class="docs-heading-anchor" href="#Symbolic-Indexing-of-Differential-Equation-Solutions">Symbolic Indexing of Differential Equation Solutions</a><a id="Symbolic-Indexing-of-Differential-Equation-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Symbolic-Indexing-of-Differential-Equation-Solutions" title="Permalink"></a></h2><p>Consider the following example:</p><pre><code class="language-julia hljs">using ModelingToolkit, OrdinaryDiffEq, SymbolicIndexingInterface, Plots
using ModelingToolkit: t_nounits as t, D_nounits as D

@parameters σ ρ β
@variables x(t) y(t) z(t) w(t)

eqs = [D(D(x)) ~ σ * (y - x),
    D(y) ~ x * (ρ - z) - y,
    D(z) ~ x * y - β * z,
    w ~ x + y + z]

@mtkbuild sys = ODESystem(eqs, t)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} xˍt\left( t \right)}{\mathrm{d}t} &amp;= \left(  - x\left( t \right) + y\left( t \right) \right) \sigma \\
\frac{\mathrm{d} y\left( t \right)}{\mathrm{d}t} &amp;=  - y\left( t \right) + x\left( t \right) \left(  - z\left( t \right) + \rho \right) \\
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} &amp;= x\left( t \right) y\left( t \right) - z\left( t \right) \beta \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} &amp;= xˍt\left( t \right)
\end{align}
 \]</p><p>The system has 4 state variables, 3 parameters, and one observed variable:</p><pre><code class="language-julia hljs">ModelingToolkit.observed(sys)</code></pre><p class="math-container">\[ \begin{align}
w\left( t \right) &amp;= x\left( t \right) + y\left( t \right) + z\left( t \right)
\end{align}
 \]</p><p>Solving the system,</p><pre><code class="language-julia hljs">u0 = [D(x) =&gt; 2.0,
    x =&gt; 1.0,
    y =&gt; 0.0,
    z =&gt; 0.0]

p = [σ =&gt; 28.0,
    ρ =&gt; 10.0,
    β =&gt; 8 / 3]

tspan = (0.0, 100.0)
prob = ODEProblem(sys, u0, tspan, p, jac = true)
sol = solve(prob, Tsit5())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 1495-element Vector{Float64}:
   0.0
   0.00014131524176735154
   0.0015544676594408668
   0.012956381586203063
   0.038266699884064254
   0.0785229194408219
   0.12210864510623465
   0.1715537595773225
   0.23112906724447269
   0.30252384441787916
   ⋮
  99.50500394035346
  99.57665664587181
  99.64283637701988
  99.72166962208854
  99.79967559234736
  99.86801139988306
  99.9330488107808
  99.99013916822045
 100.0
u: 1495-element Vector{Vector{Float64}}:
 [2.0, 0.0, 0.0, 1.0]
 [1.9960454103704428, 0.0014132521265988688, 9.986094350108851e-8, 1.0002823510089436]
 [1.956746201469907, 0.01555657123298723, 1.2096178746316906e-5, 1.0030752466310615]
 [1.6563911009012329, 0.13029732325873117, 0.0008464888055104521, 1.0236450170514986]
 [1.1011942450107057, 0.3874130541723886, 0.007445311072875279, 1.0582098434939375]
 [0.5557298342165394, 0.795954115942288, 0.031202922260444813, 1.0901348112728222]
 [0.44950103893773047, 1.2290079071325886, 0.07390401064741846, 1.1102092737279297]
 [0.9266727130791688, 1.706238215969287, 0.14159578142525983, 1.1416871413493421]
 [2.278100719563122, 2.2773793680509047, 0.2511409516498877, 1.2331771178073494]
 [4.867420100033599, 3.0146936570333036, 0.44047996356952857, 1.482457085693269]
 ⋮
 [80.19624800342062, 0.22319611264019193, 6.377999014074877, -10.921014659753743]
 [93.91125840930307, -1.9435107377092729, 5.714426748630134, -4.5809099177440675]
 [92.47053492444942, -2.2128848174269167, 4.966590148506865, 1.653115192965955]
 [78.34379148797737, 0.2736909645072598, 3.672009050521989, 8.44875583359197]
 [59.6198946986553, 5.20788553011738, 5.364594603184342, 13.834324818024804]
 [42.06609911072, 6.848722222506097, 10.923025874078832, 17.327758981163353]
 [17.746379635293263, 2.561465967609746, 14.710142246825974, 19.336065161087742]
 [-13.425186339594047, -1.9987138652095136, 12.635791951950797, 19.496277345693333]
 [-19.399440451365503, -2.4110526215294423, 11.888639585956255, 19.334495164355463]</code></pre><p>We can obtain the timeseries of any time-dependent variable using <code>getindex</code></p><pre><code class="language-julia hljs">sol[x]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Float64}:
   1.0
   1.0002823510089436
   1.0030752466310615
   1.0236450170514986
   1.0582098434939375
   1.0901348112728222
   1.1102092737279297
   1.1416871413493421
   1.2331771178073494
   1.482457085693269
   ⋮
 -10.921014659753743
  -4.5809099177440675
   1.653115192965955
   8.44875583359197
  13.834324818024804
  17.327758981163353
  19.336065161087742
  19.496277345693333
  19.334495164355463</code></pre><p>This also works for arrays or tuples of variables, including observed quantities and independent variables, for interpolating solutions, and plotting:</p><pre><code class="language-julia hljs">sol[[x, y]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Vector{Float64}}:
 [1.0, 0.0]
 [1.0002823510089436, 0.0014132521265988688]
 [1.0030752466310615, 0.01555657123298723]
 [1.0236450170514986, 0.13029732325873117]
 [1.0582098434939375, 0.3874130541723886]
 [1.0901348112728222, 0.795954115942288]
 [1.1102092737279297, 1.2290079071325886]
 [1.1416871413493421, 1.706238215969287]
 [1.2331771178073494, 2.2773793680509047]
 [1.482457085693269, 3.0146936570333036]
 ⋮
 [-10.921014659753743, 0.22319611264019193]
 [-4.5809099177440675, -1.9435107377092729]
 [1.653115192965955, -2.2128848174269167]
 [8.44875583359197, 0.2736909645072598]
 [13.834324818024804, 5.20788553011738]
 [17.327758981163353, 6.848722222506097]
 [19.336065161087742, 2.561465967609746]
 [19.496277345693333, -1.9987138652095136]
 [19.334495164355463, -2.4110526215294423]</code></pre><pre><code class="language-julia hljs">sol[(t, w)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Tuple{Float64, Float64}}:
 (0.0, 1.0)
 (0.00014131524176735154, 1.001695702996486)
 (0.0015544676594408668, 1.0186439140427952)
 (0.012956381586203063, 1.1547888291157402)
 (0.038266699884064254, 1.4530682087392015)
 (0.0785229194408219, 1.917291849475555)
 (0.12210864510623465, 2.4131211915079365)
 (0.1715537595773225, 2.9895211387438887)
 (0.23112906724447269, 3.761697437508142)
 (0.30252384441787916, 4.937630706296102)
 ⋮
 (99.50500394035346, -4.3198195330386735)
 (99.57665664587181, -0.8099939068232063)
 (99.64283637701988, 4.406820524045903)
 (99.72166962208854, 12.39445584862122)
 (99.79967559234736, 24.406804951326528)
 (99.86801139988306, 35.099507077748285)
 (99.9330488107808, 36.60767337552346)
 (99.99013916822045, 30.133355432434616)
 (100.0, 28.812082128782276)</code></pre><pre><code class="language-julia hljs">sol(1.3, idxs=x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-7.739577070673492</code></pre><pre><code class="language-julia hljs">sol(1.3, idxs=[x, w])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 -7.739577070673492
 -5.727345621422577</code></pre><pre><code class="language-julia hljs">sol(1.3, idxs=[:y, :z])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 -1.688874681282943
  3.7011061305338573</code></pre><pre><code class="language-julia hljs">plot(sol, idxs=x)</code></pre><img src="c3d35c65.svg" alt="Example block output"/><p>If necessary, <code>Symbol</code>s can be used to refer to variables. This is only valid for symbolic variables for which <a href="../api/#SymbolicIndexingInterface.hasname"><code>hasname</code></a> returns <code>true</code>. The <code>Symbol</code> used must match the one returned by <a href="../api/#SymbolicIndexingInterface.getname"><code>getname</code></a> for the variable.</p><pre><code class="language-julia hljs">hasname(x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">getname(x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">:x</code></pre><pre><code class="language-julia hljs">sol[(:x, :w)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Tuple{Float64, Float64}}:
 (1.0, 1.0)
 (1.0002823510089436, 1.001695702996486)
 (1.0030752466310615, 1.0186439140427952)
 (1.0236450170514986, 1.1547888291157402)
 (1.0582098434939375, 1.4530682087392015)
 (1.0901348112728222, 1.917291849475555)
 (1.1102092737279297, 2.4131211915079365)
 (1.1416871413493421, 2.9895211387438887)
 (1.2331771178073494, 3.761697437508142)
 (1.482457085693269, 4.937630706296102)
 ⋮
 (-10.921014659753743, -4.3198195330386735)
 (-4.5809099177440675, -0.8099939068232063)
 (1.653115192965955, 4.406820524045903)
 (8.44875583359197, 12.39445584862122)
 (13.834324818024804, 24.406804951326528)
 (17.327758981163353, 35.099507077748285)
 (19.336065161087742, 36.60767337552346)
 (19.496277345693333, 30.133355432434616)
 (19.334495164355463, 28.812082128782276)</code></pre><p>Note how when indexing with an array, the returned type is a <code>Vector{Array{Float64}}</code>, and when using a <code>Tuple</code>, the returned type is <code>Vector{Tuple{Float64, Float64}}</code>. To obtain the value of all state variables, we can use the shorthand:</p><pre><code class="language-julia hljs">sol[solvedvariables] # equivalent to sol[variable_symbols(sol)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Vector{Float64}}:
 [2.0, 0.0, 0.0, 1.0]
 [1.9960454103704428, 0.0014132521265988688, 9.986094350108851e-8, 1.0002823510089436]
 [1.956746201469907, 0.01555657123298723, 1.2096178746316906e-5, 1.0030752466310615]
 [1.6563911009012329, 0.13029732325873117, 0.0008464888055104521, 1.0236450170514986]
 [1.1011942450107057, 0.3874130541723886, 0.007445311072875279, 1.0582098434939375]
 [0.5557298342165394, 0.795954115942288, 0.031202922260444813, 1.0901348112728222]
 [0.44950103893773047, 1.2290079071325886, 0.07390401064741846, 1.1102092737279297]
 [0.9266727130791688, 1.706238215969287, 0.14159578142525983, 1.1416871413493421]
 [2.278100719563122, 2.2773793680509047, 0.2511409516498877, 1.2331771178073494]
 [4.867420100033599, 3.0146936570333036, 0.44047996356952857, 1.482457085693269]
 ⋮
 [80.19624800342062, 0.22319611264019193, 6.377999014074877, -10.921014659753743]
 [93.91125840930307, -1.9435107377092729, 5.714426748630134, -4.5809099177440675]
 [92.47053492444942, -2.2128848174269167, 4.966590148506865, 1.653115192965955]
 [78.34379148797737, 0.2736909645072598, 3.672009050521989, 8.44875583359197]
 [59.6198946986553, 5.20788553011738, 5.364594603184342, 13.834324818024804]
 [42.06609911072, 6.848722222506097, 10.923025874078832, 17.327758981163353]
 [17.746379635293263, 2.561465967609746, 14.710142246825974, 19.336065161087742]
 [-13.425186339594047, -1.9987138652095136, 12.635791951950797, 19.496277345693333]
 [-19.399440451365503, -2.4110526215294423, 11.888639585956255, 19.334495164355463]</code></pre><p>This does not include the observed variable <code>w</code>. To include observed variables in the output, the following shorthand is used:</p><pre><code class="language-julia hljs">sol[allvariables] # equivalent to sol[all_variable_symbols(sol)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1495-element Vector{Vector{Float64}}:
 [2.0, 0.0, 0.0, 1.0, 1.0]
 [1.9960454103704428, 0.0014132521265988688, 9.986094350108851e-8, 1.0002823510089436, 1.001695702996486]
 [1.956746201469907, 0.01555657123298723, 1.2096178746316906e-5, 1.0030752466310615, 1.0186439140427952]
 [1.6563911009012329, 0.13029732325873117, 0.0008464888055104521, 1.0236450170514986, 1.1547888291157402]
 [1.1011942450107057, 0.3874130541723886, 0.007445311072875279, 1.0582098434939375, 1.4530682087392015]
 [0.5557298342165394, 0.795954115942288, 0.031202922260444813, 1.0901348112728222, 1.917291849475555]
 [0.44950103893773047, 1.2290079071325886, 0.07390401064741846, 1.1102092737279297, 2.4131211915079365]
 [0.9266727130791688, 1.706238215969287, 0.14159578142525983, 1.1416871413493421, 2.9895211387438887]
 [2.278100719563122, 2.2773793680509047, 0.2511409516498877, 1.2331771178073494, 3.761697437508142]
 [4.867420100033599, 3.0146936570333036, 0.44047996356952857, 1.482457085693269, 4.937630706296102]
 ⋮
 [80.19624800342062, 0.22319611264019193, 6.377999014074877, -10.921014659753743, -4.3198195330386735]
 [93.91125840930307, -1.9435107377092729, 5.714426748630134, -4.5809099177440675, -0.8099939068232063]
 [92.47053492444942, -2.2128848174269167, 4.966590148506865, 1.653115192965955, 4.406820524045903]
 [78.34379148797737, 0.2736909645072598, 3.672009050521989, 8.44875583359197, 12.39445584862122]
 [59.6198946986553, 5.20788553011738, 5.364594603184342, 13.834324818024804, 24.406804951326528]
 [42.06609911072, 6.848722222506097, 10.923025874078832, 17.327758981163353, 35.099507077748285]
 [17.746379635293263, 2.561465967609746, 14.710142246825974, 19.336065161087742, 36.60767337552346]
 [-13.425186339594047, -1.9987138652095136, 12.635791951950797, 19.496277345693333, 30.133355432434616]
 [-19.399440451365503, -2.4110526215294423, 11.888639585956255, 19.334495164355463, 28.812082128782276]</code></pre><h3 id="Evaluating-expressions"><a class="docs-heading-anchor" href="#Evaluating-expressions">Evaluating expressions</a><a id="Evaluating-expressions-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-expressions" title="Permalink"></a></h3><p><code>getu</code> also generates functions for expressions if the object passed to it supports <a href="../api/#SymbolicIndexingInterface.observed"><code>observed</code></a>. For example:</p><pre><code class="language-julia hljs">getu(prob, x + y + z)(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>To evaluate this function using values other than the ones contained in <code>prob</code>, we need an object that supports <a href="../api/#SymbolicIndexingInterface.state_values"><code>state_values</code></a>, <a href="../api/#SymbolicIndexingInterface.parameter_values"><code>parameter_values</code></a>, <a href="../api/#SymbolicIndexingInterface.current_time"><code>current_time</code></a>. SymbolicIndexingInterface provides the <a href="../api/#SymbolicIndexingInterface.ProblemState"><code>ProblemState</code></a> type, which has trivial implementations of the above functions. We can thus do:</p><pre><code class="language-julia hljs">temp_state = ProblemState(; u = [0.1, 0.2, 0.3, 0.4], p = parameter_values(prob))
getu(prob, x + y + z)(temp_state)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.9000000000000001</code></pre><p>Note that providing all of the state vector, parameter object and time may not be necessary if the function generated by <code>observed</code> does not access them. ModelingToolkit.jl generates functions that access the parameters regardless of whether they are used in the expression, and thus it needs to be provided to the <code>ProblemState</code>.</p><h2 id="Parameter-Indexing:-Getting-and-Setting-Parameter-Values"><a class="docs-heading-anchor" href="#Parameter-Indexing:-Getting-and-Setting-Parameter-Values">Parameter Indexing: Getting and Setting Parameter Values</a><a id="Parameter-Indexing:-Getting-and-Setting-Parameter-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Indexing:-Getting-and-Setting-Parameter-Values" title="Permalink"></a></h2><p>Parameters cannot be obtained using this syntax, and instead require using <a href="../api/#SymbolicIndexingInterface.getp"><code>getp</code></a> and <a href="../api/#SymbolicIndexingInterface.setp"><code>setp</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The reason why parameters use a separate syntax is to be able to ensure type stability of the <code>sol[x]</code> indexing. Without separating the parameter indexing, the return type of symbolic indexing could be anything a parameter can be, which is general is not the same type as state variables!</p></div></div><pre><code class="language-julia hljs">σ_getter = getp(sys, σ)
σ_getter(sol) # can also pass `prob`</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">28.0</code></pre><p>Note that this also supports arrays/tuples of parameter symbols:</p><pre><code class="language-julia hljs">σ_ρ_getter = getp(sys, (σ, ρ))
σ_ρ_getter(sol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(28.0, 10.0)</code></pre><p>Now suppose the system has to be solved with a different value of the parameter <code>β</code>.</p><pre><code class="language-julia hljs">β_setter = setp(sys, β)
β_setter(prob, 3)</code></pre><p>The updated parameter values can be checked using <a href="../api/#SymbolicIndexingInterface.parameter_values"><code>parameter_values</code></a>.</p><pre><code class="language-julia hljs">parameter_values(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.MTKParameters{Vector{Float64}, Tuple{}, Tuple{}, Tuple{}}([10.0, 3.0, 28.0], (), (), ())</code></pre><p>When solving the new system, note that the parameter getter functions still work on the new solution object.</p><pre><code class="language-julia hljs">sol2 = solve(prob, Tsit5())
σ_getter(sol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">28.0</code></pre><pre><code class="language-julia hljs">σ_ρ_getter(sol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(28.0, 10.0)</code></pre><p>To set the entire parameter vector at once, <a href="../api/#SymbolicIndexingInterface.setp"><code>setp</code></a> can be used (note that the order of symbols passed to <code>setp</code> must match the order of values in the array).</p><pre><code class="language-julia hljs">setp(prob, parameter_symbols(prob))(prob, [29.0, 11.0, 2.5])
parameter_values(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.MTKParameters{Vector{Float64}, Tuple{}, Tuple{}, Tuple{}}([29.0, 11.0, 2.5], (), (), ())</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>These getters and setters generate high-performance functions for the specific chosen symbols or collection of symbols. Caching the getter/setter function and reusing it on other problem/solution instances can be the key to achieving good performance. Note that this caching is allowed only when the symbolic system is unchanged (it&#39;s fine for the numerical values to have changed, but not the underlying equations).</p></div></div><h2 id="Re-creating-a-buffer"><a class="docs-heading-anchor" href="#Re-creating-a-buffer">Re-creating a buffer</a><a id="Re-creating-a-buffer-1"></a><a class="docs-heading-anchor-permalink" href="#Re-creating-a-buffer" title="Permalink"></a></h2><p>To re-create a buffer (of unknowns or parameters) use <a href="../api/#SymbolicIndexingInterface.remake_buffer"><code>remake_buffer</code></a>. This allows changing the type of values in the buffer (for example, changing the value of a parameter from <code>Float64</code> to <code>Float32</code>).</p><pre><code class="language-julia hljs">remake_buffer(sys, prob.p, Dict(σ =&gt; 1f0, ρ =&gt; 2f0, β =&gt; 3f0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.MTKParameters{Vector{Float32}, Tuple{}, Tuple{}, Tuple{}}(Float32[2.0, 3.0, 1.0], (), (), ())</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../terminology/">« Terminology</a><a class="docs-footer-nextpage" href="../simple_sii_sys/">Simple Demonstration of a Symbolic System Structure »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 16 October 2024 05:54">Wednesday 16 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
